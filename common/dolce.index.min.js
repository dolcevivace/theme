/* Dolce & Vivace
 * https://base.dolcevivace.com/
 * Copyright Dolce & Vivace
 */
document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("more");if(t){const s=document.getElementById("moreloader"),d=document.getElementById("max_page"),r=document.getElementById("next_page"),a=document.getElementById("load_items_url").textContent,m=document.getElementById("load_items_params").textContent;let u=!1,y=!1,f=parseInt(d.textContent,10),p=parseInt(r.textContent,10);function e(t){t.style.display="none"}function n(){t.querySelector("span").style.visibility="hidden",s.style.display="block"}function o(){s.style.display="none",t.querySelector("span").style.visibility="visible"}function c(t){const e=document.getElementById("products"),n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)e.appendChild(n.firstChild)}function l(){const t=document.getElementById("item-boundary"),e=document.getElementById("item-last-text");if(t&&e){const n=parseInt(t.textContent.trim(),10),o=e.textContent.trim();if(!isNaN(n)){const t=document.querySelectorAll("#products .item");t.forEach(t=>{const e=t.querySelector(".item-stock");if(e){const c=parseInt(e.textContent.trim(),10);if(c>=1&&c<=n){const e=t.querySelector(".item-status");if(e&&!e.querySelector(".uk-label.label-stock")){const t=document.createElement("span");t.className="uk-label label-stock",t.textContent=o,e.appendChild(t)}}}})}}}async function i(){try{n();const i=await fetch(a+p+m),s=await i.text(),d=document.documentElement.scrollTop;c(s),l(),document.documentElement.scrollTop=d,p+=1,r.textContent=p,"function"==typeof sal&&sal().reset(),f<p&&e(t)}catch(t){console.error("Error loading more items:",t)}finally{u=!1,o()}}(1===f||p>f)&&e(t),t.addEventListener("click",function(t){t.preventDefault(),u||y||(u=!0,i())})}}),document.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll(".item .price");t.forEach(function(t){const e=t.innerHTML,n=e.replace(/\(/g,"<wbr>(");t.innerHTML=n})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("more");t&&t.addEventListener("click",function(t){const e=t.target.closest("a");if(e){t.preventDefault();const e=window.location.href,n=document.getElementById("shop_url"),o=n?n.textContent.trim():"",c=o.endsWith("/")?o:`${o}/`,l=e.match(/categories\/.+/);let i="";l&&(i=l[0].replace(/([0-9]+\/)([0-9]+)$/,"$1"),i.endsWith("/")||(i+="/"));const s=document.getElementById("next_page"),d=s?parseInt(s.textContent.trim(),10):1;if(d>1&&!e.includes("/search?q")){const t=`${c}${i}${d}`;window.history.pushState(null,null,t)}}})});